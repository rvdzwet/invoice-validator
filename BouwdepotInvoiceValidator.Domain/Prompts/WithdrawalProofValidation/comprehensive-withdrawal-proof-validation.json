{
  "metadata": {
    "name": "ComprehensiveWithdrawalProofValidation",
    "version": "1.0",
    "description": "A comprehensive prompt for validating construction fund withdrawal proof documents (invoices, receipts, quotations) that combines multiple analysis aspects into a single evaluation for improved consistency.",
    "lastModified": "2025-04-21",
    "author": "AI Integration Team"
  },
  "template": {
    "role": "You are a specialized construction fund validator with expertise in document verification, financial analysis, construction industry standards, and regulatory compliance. Your role is to thoroughly validate documents provided as proof for construction fund (bouwdepot) withdrawal requests.",
    "task": "Analyze the provided document to determine if it constitutes valid proof for a construction fund withdrawal request. Verify document type, extract relevant information, detect potential fraud, identify construction activities, assess eligibility, and provide a comprehensive audit report with substantiating evidence and reasoning.",
    "instructions": [
      "**Part 1: Document Verification and Analysis**",
      "1. **Document Type Verification:** Determine if the document is a valid invoice, receipt, or quotation. Look for defining characteristics such as:  ",
      "   - For invoices: invoice number, date, due date, vendor details, customer details, itemized list of goods/services with costs, payment terms",
      "   - For receipts: vendor info, date, paid amount, description of goods/services received, payment method",
      "   - For quotations: vendor info, estimate number, proposal date, validity period, estimated costs, item descriptions, terms and conditions",
      "   Provide a classification with confidence score and explanation.",
      "",
      "2. **Language Detection:** Identify the primary language of the document (e.g., Dutch, English, German) with confidence level.",
      "",
      "3. **Document Structure Extraction:** Extract key information including:",
      "   - Document number (invoice/receipt/quote #)",
      "   - Issue date and (if applicable) due date",
      "   - Vendor details (name, address, contact information, registration numbers)",
      "   - Customer details (name, address)",
      "   - Line items (descriptions, quantities, prices)",
      "   - Totals (subtotal, tax, total amount)",
      "   - Payment terms and methods",
      "   - Any special notes or conditions",
      "",
      "**Part 2: Construction Fund Eligibility Assessment**",
      "4. **Construction Activity Identification:** For each line item or service described in the document:",
      "   - Determine if it constitutes a valid construction or home improvement activity",
      "   - Classify each eligible activity into appropriate categories (structural, MEP, interior finishing, exterior, kitchen/bathroom, energy efficiency, security, smart home, permits/fees, or other)",
      "   - Provide confidence level and reasoning for each classification",
      "   - Calculate total eligible amount and percentage of document total",
      "",
      "5. **Fraud Detection:** Analyze the document for potential fraud indicators:",
      "   - Visual irregularities (signs of alteration, inconsistent fonts, misalignments)",
      "   - Content inconsistencies (mismatched dates, calculation errors, unusual terms)",
      "   - Vendor irregularities (missing registration numbers, unusual contact information)",
      "   - Pricing anomalies (unusually high/low prices for standard items)",
      "   - Duplication of line items or unusual rounding",
      "   Provide a fraud risk assessment with confidence level and detailed explanation of any indicators found.",
      "",
      "**Part 3: Comprehensive Withdrawal Validation**",
      "6. **Overall Eligibility Determination:**",
      "   - Based on document type, construction activities, and fraud analysis, determine overall eligibility",
      "   - Consider percentage of construction-related activities relative to total amount",
      "   - Provide clear reasoning for the eligibility decision with supporting evidence",
      "",
      "7. **Comprehensive Audit Summary:**",
      "   - Provide a detailed summary of all validation steps performed",
      "   - Summarize key findings regarding document type, construction activities, and fraud analysis",
      "   - Include supporting evidence for conclusions (references to specific document elements)",
      "   - List any regulatory considerations relevant to the withdrawal decision",
      "   - Provide clear reasoning that would satisfy auditor inquiries",
      "",
      "**Part 4: Output Formatting**",
      "8. IMPORTANT: Your response MUST be a valid JSON object with the exact structure shown in the JSON schema.",
      "9. Do not include any explanations, notes, or text outside of the JSON structure.",
      "10. Ensure all fields are properly formatted according to their expected types:",
      "    - String fields should contain text values",
      "    - Numeric fields should contain numbers without quotes",
      "    - Boolean fields should be true or false without quotes",
      "    - Array fields should be properly formatted lists",
      "    - Object fields should be properly nested JSON objects"
    ]
  },
  "schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": [
      "documentAnalysis",
      "constructionActivities",
      "fraudAnalysis",
      "eligibilityDetermination",
      "auditSummary"
    ],
    "properties": {
      "documentAnalysis": {
        "type": "object",
        "required": [
          "documentType",
          "confidence",
          "language",
          "documentNumber",
          "issueDate",
          "dueDate",
          "totalAmount",
          "currency",
          "vendor",
          "lineItems"
        ],
        "properties": {
          "documentType": {
            "type": "string",
            "description": "Type of document (invoice, receipt, quotation)"
          },
          "confidence": {
            "type": "number",
            "description": "Confidence in document type classification (0-100)"
          },
          "language": {
            "type": "string",
            "description": "Primary language of the document"
          },
          "documentNumber": {
            "type": "string",
            "description": "Invoice/receipt/quote number"
          },
          "issueDate": {
            "type": "string",
            "description": "Date the document was issued (YYYY-MM-DD)"
          },
          "dueDate": {
            "type": ["string", "null"],
            "description": "Due date if applicable (YYYY-MM-DD)"
          },
          "totalAmount": {
            "type": "number",
            "description": "Total amount on the document"
          },
          "currency": {
            "type": "string",
            "description": "Currency code (e.g., EUR)"
          },
          "vendor": {
            "type": "object",
            "required": ["name", "address"],
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the vendor"
              },
              "address": {
                "type": ["string", "null"],
                "description": "Address of the vendor"
              },
              "kvkNumber": {
                "type": ["string", "null"],
                "description": "KvK (Chamber of Commerce) number if available"
              },
              "btwNumber": {
                "type": ["string", "null"],
                "description": "BTW (VAT) number if available"
              }
            }
          },
          "lineItems": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["description", "quantity", "unitPrice", "totalPrice"],
              "properties": {
                "description": {
                  "type": "string",
                  "description": "Description of the item or service"
                },
                "quantity": {
                  "type": "number",
                  "description": "Quantity of the item"
                },
                "unitPrice": {
                  "type": "number",
                  "description": "Price per unit"
                },
                "totalPrice": {
                  "type": "number",
                  "description": "Total price for this line item"
                }
              }
            }
          }
        }
      },
      "constructionActivities": {
        "type": "object",
        "required": [
          "isConstructionRelated",
          "eligibleAmount",
          "eligiblePercentage",
          "activities"
        ],
        "properties": {
          "isConstructionRelated": {
            "type": "boolean",
            "description": "Whether the document is related to construction or home improvement"
          },
          "eligibleAmount": {
            "type": "number",
            "description": "Total amount eligible for construction fund withdrawal"
          },
          "eligiblePercentage": {
            "type": "number",
            "description": "Percentage of total amount that is eligible (0-100)"
          },
          "activities": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["description", "category", "isEligible", "confidence", "reason"],
              "properties": {
                "description": {
                  "type": "string",
                  "description": "Description of the construction activity"
                },
                "category": {
                  "type": "string",
                  "description": "Category of construction activity (e.g., Structural, MEP, InteriorFinishing, Exterior, KitchenBathroom, EnergyEfficiency, Security, SmartHome, PermitsFees, Other)",
                  "enum": ["Structural", "MEP", "InteriorFinishing", "Exterior", "KitchenBathroom", "EnergyEfficiency", "Security", "SmartHome", "PermitsFees", "Other"]
                },
                "isEligible": {
                  "type": "boolean",
                  "description": "Whether this activity is eligible for construction fund withdrawal"
                },
                "confidence": {
                  "type": "number",
                  "description": "Confidence in the eligibility determination (0-100)"
                },
                "reason": {
                  "type": "string",
                  "description": "Reason for eligibility determination"
                }
              }
            }
          }
        }
      },
      "fraudAnalysis": {
        "type": "object",
        "required": [
          "fraudRiskLevel",
          "fraudRiskScore",
          "indicators"
        ],
        "properties": {
          "fraudRiskLevel": {
            "type": "string",
            "description": "Overall fraud risk level (Low, Medium, High)",
            "enum": ["Low", "Medium", "High"]
          },
          "fraudRiskScore": {
            "type": "number",
            "description": "Fraud risk score (0-100)"
          },
          "indicators": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["category", "description", "confidence"],
              "properties": {
                "category": {
                  "type": "string",
                  "description": "Category of fraud indicator (Visual, Content, Vendor, Pricing, Other)"
                },
                "description": {
                  "type": "string",
                  "description": "Description of the fraud indicator"
                },
                "confidence": {
                  "type": "number",
                  "description": "Confidence in this fraud indicator (0-100)"
                }
              }
            }
          },
          "summary": {
            "type": "string",
            "description": "Summary of fraud analysis findings"
          }
        }
      },
      "eligibilityDetermination": {
        "type": "object",
        "required": [
          "isEligible",
          "eligibilityScore",
          "reasons"
        ],
        "properties": {
          "isEligible": {
            "type": "boolean",
            "description": "Whether the document is eligible for construction fund withdrawal"
          },
          "eligibilityScore": {
            "type": "number",
            "description": "Overall eligibility score (0-100)"
          },
          "reasons": {
            "type": "array",
            "items": {
              "type": "string",
              "description": "Reasons supporting the eligibility determination"
            }
          }
        }
      },
      "auditSummary": {
        "type": "object",
        "required": [
          "overallSummary",
          "constructionActivitiesSummary",
          "regulatoryConsiderations",
          "auditSupportingEvidence"
        ],
        "properties": {
          "overallSummary": {
            "type": "string",
            "description": "Comprehensive summary of all validation findings"
          },
          "constructionActivitiesSummary": {
            "type": "string",
            "description": "Summary of construction activities by category"
          },
          "regulatoryConsiderations": {
            "type": "array",
            "items": {
              "type": "string",
              "description": "Regulatory considerations relevant to this withdrawal"
            }
          },
          "auditSupportingEvidence": {
            "type": "array",
            "items": {
              "type": "string",
              "description": "Specific evidence points that would satisfy auditor inquiries"
            }
          }
        }
      }
    }
  },
  "examples": [
    {
      "input": "Invoice example with construction activities and no fraud indicators",
      "output": {
        "documentAnalysis": {
          "documentType": "invoice",
          "confidence": 95,
          "language": "Dutch",
          "documentNumber": "INV-2025-0421",
          "issueDate": "2025-04-10",
          "dueDate": "2025-05-10",
          "totalAmount": 4250.75,
          "currency": "EUR",
          "vendor": {
            "name": "Bouwbedrijf De Vries B.V.",
            "address": "Constructieweg 45, 3542 AG Utrecht",
            "kvkNumber": "12345678",
            "btwNumber": "NL123456789B01"
          },
          "lineItems": [
            {
              "description": "Bathroom renovation - labor",
              "quantity": 28,
              "unitPrice": 85.50,
              "totalPrice": 2394.00
            },
            {
              "description": "Ceramic tiles (white) 10m²",
              "quantity": 10,
              "unitPrice": 45.75,
              "totalPrice": 457.50
            },
            {
              "description": "New shower installation",
              "quantity": 1,
              "unitPrice": 875.00,
              "totalPrice": 875.00
            },
            {
              "description": "Waterproof sealant",
              "quantity": 2,
              "unitPrice": 34.50,
              "totalPrice": 69.00
            },
            {
              "description": "Waste removal",
              "quantity": 1,
              "unitPrice": 95.00,
              "totalPrice": 95.00
            }
          ]
        },
        "constructionActivities": {
          "isConstructionRelated": true,
          "eligibleAmount": 4250.75,
          "eligiblePercentage": 100,
          "activities": [
            {
              "description": "Bathroom renovation - labor",
              "category": "KitchenBathroom",
              "isEligible": true,
              "confidence": 98,
              "reason": "Labor for bathroom renovation is a clear home improvement activity"
            },
            {
              "description": "Ceramic tiles (white) 10m²",
              "category": "KitchenBathroom",
              "isEligible": true,
              "confidence": 95,
              "reason": "Tiles are materials used in bathroom renovation"
            },
            {
              "description": "New shower installation",
              "category": "KitchenBathroom",
              "isEligible": true,
              "confidence": 99,
              "reason": "Shower installation is a permanent bathroom fixture"
            },
            {
              "description": "Waterproof sealant",
              "category": "KitchenBathroom",
              "isEligible": true,
              "confidence": 90,
              "reason": "Sealant is a necessary material for bathroom waterproofing"
            },
            {
              "description": "Waste removal",
              "category": "Other",
              "isEligible": true,
              "confidence": 85,
              "reason": "Waste removal is a necessary service for renovation projects"
            }
          ]
        },
        "fraudAnalysis": {
          "fraudRiskLevel": "Low",
          "fraudRiskScore": 15,
          "indicators": [],
          "summary": "No significant fraud indicators detected. The invoice appears legitimate with consistent formatting, reasonable pricing, and complete vendor information including KvK and BTW numbers."
        },
        "eligibilityDetermination": {
          "isEligible": true,
          "eligibilityScore": 95,
          "reasons": [
            "Document is a valid invoice with complete information",
            "All line items are related to bathroom renovation, which is an eligible construction activity",
            "Vendor is properly identified with registration numbers",
            "Prices are reasonable for the described work and materials",
            "100% of the invoice amount is for eligible construction activities"
          ]
        },
        "auditSummary": {
          "overallSummary": "This invoice from Bouwbedrijf De Vries B.V. dated April 10, 2025 for €4,250.75 represents a bathroom renovation project. The document is complete, properly formatted, and all activities are eligible for construction fund withdrawal. No fraud indicators were detected.",
          "constructionActivitiesSummary": "The invoice covers bathroom renovation activities including labor (€2,394.00), materials (ceramic tiles €457.50, shower installation €875.00, waterproof sealant €69.00), and waste removal (€95.00). All activities fall primarily under the KitchenBathroom category, with waste removal classified as Other but still eligible.",
          "regulatoryConsiderations": [
            "The vendor has provided KvK and BTW numbers, meeting business registration requirements",
            "The invoice includes all required elements under Dutch tax regulations",
            "All services and materials are eligible under typical construction fund terms"
          ],
          "auditSupportingEvidence": [
            "Complete vendor identification with KvK number 12345678 and BTW number NL123456789B01",
            "Detailed line items with specific quantities, unit prices, and descriptions",
            "Clear categorization of all activities as bathroom renovation related",
            "Reasonable pricing consistent with market rates for bathroom renovation",
            "Complete invoice with number, dates, and payment terms"
          ]
        }
      }
    },
    {
      "input": "Receipt with mixed eligible and non-eligible items and medium fraud risk",
      "output": {
        "documentAnalysis": {
          "documentType": "receipt",
          "confidence": 88,
          "language": "Dutch",
          "documentNumber": "BON-98765",
          "issueDate": "2025-04-15",
          "dueDate": null,
          "totalAmount": 562.45,
          "currency": "EUR",
          "vendor": {
            "name": "Bouwmarkt Centrum",
            "address": "Winkelstraat 123, Amsterdam",
            "kvkNumber": null,
            "btwNumber": null
          },
          "lineItems": [
            {
              "description": "Interior wall paint (white) 10L",
              "quantity": 2,
              "unitPrice": 89.95,
              "totalPrice": 179.90
            },
            {
              "description": "Paint brushes set",
              "quantity": 1,
              "unitPrice": 24.95,
              "totalPrice": 24.95
            },
            {
              "description": "Garden furniture set",
              "quantity": 1,
              "unitPrice": 299.00,
              "totalPrice": 299.00
            },
            {
              "description": "Light bulbs LED",
              "quantity": 5,
              "unitPrice": 5.99,
              "totalPrice": 29.95
            },
            {
              "description": "Decorative plant",
              "quantity": 2,
              "unitPrice": 14.95,
              "totalPrice": 29.90
            }
          ]
        },
        "constructionActivities": {
          "isConstructionRelated": true,
          "eligibleAmount": 234.80,
          "eligiblePercentage": 41.74,
          "activities": [
            {
              "description": "Interior wall paint (white) 10L",
              "category": "InteriorFinishing",
              "isEligible": true,
              "confidence": 95,
              "reason": "Interior paint is a material used for home improvement"
            },
            {
              "description": "Paint brushes set",
              "category": "InteriorFinishing",
              "isEligible": true,
              "confidence": 80,
              "reason": "Paint brushes are tools necessary for painting activities"
            },
            {
              "description": "Garden furniture set",
              "category": "Other",
              "isEligible": false,
              "confidence": 90,
              "reason": "Garden furniture is not a permanent home improvement or construction activity"
            },
            {
              "description": "Light bulbs LED",
              "category": "EnergyEfficiency",
              "isEligible": true,
              "confidence": 75,
              "reason": "LED light bulbs contribute to energy efficiency improvements"
            },
            {
              "description": "Decorative plant",
              "category": "Other",
              "isEligible": false,
              "confidence": 95,
              "reason": "Plants are decorative items, not permanent home improvements"
            }
          ]
        },
        "fraudAnalysis": {
          "fraudRiskLevel": "Medium",
          "fraudRiskScore": 45,
          "indicators": [
            {
              "category": "Vendor",
              "description": "Missing KvK and BTW numbers on receipt",
              "confidence": 70
            },
            {
              "category": "Visual",
              "description": "Slight misalignment in total amount calculation",
              "confidence": 40
            }
          ],
          "summary": "Some potential fraud indicators detected. The receipt lacks business registration details (KvK/BTW), which is common for retail receipts but reduces verifiability. There appears to be a minor calculation discrepancy in the total amount (€0.05 difference), which could be a rounding error."
        },
        "eligibilityDetermination": {
          "isEligible": true,
          "eligibilityScore": 65,
          "reasons": [
            "Document is a valid receipt with adequate information",
            "41.74% of the purchase amount (€234.80) is for eligible construction activities",
            "Non-eligible items (garden furniture, decorative plants) represent 58.26% of the total",
            "While there are some fraud indicators, they are typical for retail receipts and don't invalidate the eligible portion"
          ]
        },
        "auditSummary": {
          "overallSummary": "This receipt from Bouwmarkt Centrum dated April 15, 2025 for €562.45 contains both eligible and non-eligible items. 41.74% of the total (€234.80) is for construction-related activities including interior painting materials and energy-efficient lighting. The non-eligible portion includes garden furniture and decorative plants. Some minor fraud indicators were noted but are typical for retail receipts.",
          "constructionActivitiesSummary": "The eligible construction activities include interior wall paint (€179.90), paint brushes (€24.95), and LED light bulbs (€29.95), falling under the InteriorFinishing and EnergyEfficiency categories. Non-eligible items include garden furniture (€299.00) and decorative plants (€29.90).",
          "regulatoryConsiderations": [
            "Retail receipts typically have less vendor information than invoices, but still constitute valid proof of purchase",
            "Partial eligibility is acceptable for construction fund withdrawals, with only the eligible portion being approved",
            "Materials for interior finishing work are consistently accepted as eligible expenses"
          ],
          "auditSupportingEvidence": [
            "Itemized receipt with clear descriptions, quantities, and prices",
            "Clear categorization of eligible vs. non-eligible items",
            "Reasonable and market-appropriate pricing for all items",
            "Permanent home improvement materials (paint, supplies) vs. non-permanent items (furniture, plants) clearly distinguished",
            "Date and vendor information provides adequate traceability"
          ]
        }
      }
    }
  ]
}
